{% extends "base.html" %}
{% set hide_header = true %}
{% set hide_footer = true %}
{% block title %}Enable 2FA - CourseXcel{% endblock %}
{% block content %}
<div style="
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    background: #f9f9f9;
">
    <div style="
        text-align: center;
        background: white;
        padding: 40px 50px;
        border-radius: 12px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        max-width: 480px;
        width: 100%;
    ">
        <h2 style="margin-bottom: 15px;">
            <i class="fa-solid fa-shield-halved" style="margin-right: 6px;"></i>
            Enable Two-Factor Authentication
        </h2>
        <p style="color: #555; margin-bottom: 20px;">
            Scan the QR code below using <b>Google Authenticator</b> or <b>Microsoft Authenticator</b>,
            then enter your 6-digit code to verify.
        </p>

        <!-- QR Code -->
        <img src="{{ url_for('twofa_qr', uri=otpauth_uri) }}" 
             alt="2FA QR"
             class="twofa-qr"
             style="width:240px; height:240px; border:1px solid #ccc; border-radius:8px; margin:20px 0;">

        <p style="font-size: 14px; color: #666; margin-bottom: 25px;">
            <i class="fa-regular fa-clock" style="color:#1E90FF;"></i>
            Each code refreshes every <b>30 seconds</b>.
        </p>

        <form method="POST" style="max-width: 320px; margin: 0 auto;">
            <div class="input-group mb-3">
                <input name="code" class="form-control text-center"
                    placeholder="Enter 6-digit code"
                    maxlength="6" required
                    style="font-size: 16px; letter-spacing: 3px; text-align: center;">
            </div>
            <button type="submit"
                class="twofa-button"
                style="width:100%; background:#1E90FF; color:white; border:none; padding:10px 0; border-radius:6px; font-weight:bold;">
                <i class="fa-solid fa-key"></i> Verify & Enable
            </button>
        </form>

        {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for cat, msg in messages %}
                <div class="flash-message {{ cat }}" style="margin-top:15px;">{{ msg|safe }}</div>
            {% endfor %}
        {% endif %}
        {% endwith %}
    </div>
</div>
{% endblock %}
